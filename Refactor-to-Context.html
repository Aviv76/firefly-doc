<!DOCTYPE html>
<html lang="en" class="js flexbox flexboxlegacy canvas canvastext webgl no-touch geolocation postmessage websqldatabase indexeddb hashchange history draganddrop websockets rgba hsla multiplebgs backgroundsize borderimage borderradius boxshadow textshadow opacity cssanimations csscolumns cssgradients cssreflections csstransforms csstransforms3d csstransitions fontface generatedcontent video audio localstorage sessionstorage webworkers applicationcache svg inlinesvg smil svgclippaths">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta charset="utf-8" />
    <meta name="keywords" content="">

    <title>Refactor to Context</title>
    <link rel="shortcut icon" href="favicon.png" type="image/x-icon" />
    <link rel="stylesheet" href="assets/css/toc.css" />
    <link rel="stylesheet" href="assets/css/highlight.css" />
    <link rel="stylesheet" href="assets/css/prism.css" />
    <link rel="stylesheet" href="assets/css/prism-csdiff.css" />


    <link rel="stylesheet" href="assets/css/theme_firefly.css" />
    <link rel="stylesheet" href="assets/css/mermaid.css" />
</head>
<body class="markdown-body" role="document">

    <div class="wrapper">

        <div class="middle">

            <div class="container">

                <div class="content" role="navigation" aria-label="footer navigation">
                    <a id="previousButton" class="btn btn-neutral float-left" style="visibility:hidden">Previous</a> <a id="nextButton" class="btn btn-neutral float-right" style="visibility:hidden">Next</a>
                </div>
                <div class="content"><h1 id="refactor-to-context">Refactor to Context</h1>
<p>Great, so we have the function, but how will we find it once we need it. This being a static function, somewhere in my code will make it very difficult to find when I need it.<br />
Usually when I write a filter, I select my column, then press the dot key, and select the “IsEqualTo” method or the “IsGreaterThen” method. I would like to be able to select the “IsIn” method that we just created as well.</p>
<p>No problem, let’s add it to the “TextColumn” class in ENV – so that any time we use a text column, this method will be available to us.</p>
<pre data-line="" class="language-csdiff line-numbers"><code>namespace ENV.Data
{
    public class TextColumn : Firefly.Box.Data.TextColumn, 
                                         IReadOnly, IENVColumn
    {
.......
        public FilterCollection IsIn(params Text[] vals)
        {
            var where = new FilterCollection();
            var args = new ArrayList();
            args.Add(this);
            int i = 1;
            string inStatement = "{0} in (";

            foreach (var val in vals)
            {
                if (i &amp;gt; 1)
                    inStatement += ",";
                inStatement += "{" + i++ + "}";
                args.Add(val);
            }
            inStatement += ")";

            where.Add(inStatement, args.ToArray());
            return where;
        }
.......
    }
}
 </code></pre>
<p>Note that this method is no longer static, and no longer receives the TextColumn parameter called “col”. Instead it uses the “this” operator – referring to the current instance of TextColumn.</p>
<p>So now instead of writing:</p>
<pre data-line="" class="language-csdiff line-numbers"><code>return o.CountRows(IsIn(o.CustomerID, "TOMSP", "HANAR","RICSU"));
 </code></pre>
<p>We can write:</p>
<pre data-line="" class="language-csdiff line-numbers"><code>return o.CountRows(o.CustomerID.IsIn("TOMSP", "HANAR", "RICSU"));
 </code></pre>
<p>To better understand all the different aspects of the “Where” I recommend that you have a look at the following topics in our documentation:</p>
<hr />
<ul>
<li>Where – <a href="http://www.fireflymigration.com/reference/html/P_Firefly_Box_BusinessProcess_Where.htm">P_Firefly_Box_BusinessProcess_Where.htm</a></li>
<li>ICustomFilterMember Interface – <a href="http://www.fireflymigration.com/reference/html/T_Firefly_Box_Data_Advanced_ICustomFilterMember.htm">T_Firefly_Box_Data_Advanced_ICustomFilterMember.htm</a></li>
</ul>
<hr />
<p>Also have a look at the “UserDbMethods”  class in “ENV”</p>
<br /><hr />Help us improve, <a href="https://github.com/FireflyMigration/firefly-doc/blob/master//02-Development/03-Articles/DataAccess/27-Making-the-most-out-of-Where/06-Refactor-to-Context.md">Edit this page on GitHub</a></div><!-- .content -->
                
            </div><!-- .container-->
        
            <aside class="left-sidebar">
                <div class="wy-side-nav-search-ff">
                    <a href="" class="test">  <img src="assets/img/logo-big.png"></a>
                </div><div id="menuTree"</div>
            </aside><!-- .left-sidebar -->

            <aside class="right-sidebar"></aside><!-- .right-sidebar -->

        </div><!-- .middle-->



    </div>


    <script src="assets/js/mermaid.js"></script>
    <script src="assets/js/prism-start.js"></script>
    <script src="assets/js/prism-clike.js"></script>
    <script src="assets/js/prism-markup.js"></script>
    <script src="assets/js/prism-css.js"></script>
    <script src="assets/js/prism-javascript.js"></script>

    <script src="assets/js/prism-diff.js"></script>
    <script src="assets/js/prism-csdiff.js"></script>
    <script src="assets/js/prism-function.js"></script>

    <script src="assets/js/jquery-3.1.1.js"></script>
    <script src="assets/js/tree.js"></script>
    <script language="javascript">
        buildTree('menuTree', 'refactor-to-context.html', 'previousButton', 'nextButton');
    </script>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-4806432-3', 'auto');
  ga('send', 'pageview');

    </script>
</body>
</html>