<!DOCTYPE html>
<html lang="en" class="js flexbox flexboxlegacy canvas canvastext webgl no-touch geolocation postmessage websqldatabase indexeddb hashchange history draganddrop websockets rgba hsla multiplebgs backgroundsize borderimage borderradius boxshadow textshadow opacity cssanimations csscolumns cssgradients cssreflections csstransforms csstransforms3d csstransitions fontface generatedcontent video audio localstorage sessionstorage webworkers applicationcache svg inlinesvg smil svgclippaths">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta charset="utf-8" />
    <meta name="keywords" content="">

    <title>Application setup code</title>
    <link rel="shortcut icon" href="favicon.png" type="image/x-icon" />
    <link rel="stylesheet" href="assets/css/toc.css" />
    <link rel="stylesheet" href="assets/css/highlight.css" />
    <link rel="stylesheet" href="assets/css/prism.css" />
    <link rel="stylesheet" href="assets/css/prism-csdiff.css" />


    <link rel="stylesheet" href="assets/css/theme_firefly.css" />
    <link rel="stylesheet" href="assets/css/mermaid.css" />
</head>
<body class="markdown-body" role="document">

    <div class="wrapper">

        <div class="middle">

            <div class="container">

                <div class="content" role="navigation" aria-label="footer navigation">
                    <a id="previousButton" class="btn btn-neutral float-left" style="visibility:hidden">Previous</a> <a id="nextButton" class="btn btn-neutral float-right" style="visibility:hidden">Next</a>
                </div>
                <div class="content"><h1 id="application-setup-code">Application setup code</h1>
<p>The original migrated application does it’s basic setup in the “Program.Main” method.</p>
<p>That setup includes loading the ini file and similar operations.</p>
<p>We’ll start by copying the ini from the migrated project to the web project:<br />
<img src="Solution_explorer_northwind2.png" alt="" /></p>
<p>In MVC it’s customary to put such configuration code in the “App_Start” folder.</p>
<p>We’ll add a new class and call it “NorthwindConfig”:<br />
<img src="Solution_explorer_northwind3.png" alt="" /></p>
<p>To that class we’ll add a method that will perform all the required configuration.<br />
<img src="App_start.jpg" alt="" /></p>
<pre data-line="" class="language-csdiff line-numbers"><code>using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using ENV;

namespace NorthwindWeb.App_Start
{
    public class NorthwindConfig
    {
        public static void Init()
        {
            Common.SuppressDialogs();
            ENV.Data.DataProvider.ConnectionManager.UseConnectionPool = true;
            //ENV.UserSettings.Version10Compatible = true; use only if you are using uniPaaS INI 

            //ENV.Data.DataProvider.OracleHelper.UseOracleODPClient("DD/MM/YYYY", "BINARY", ".,"); When using Oracle
            ENV.Data.DateColumn.GlobalDefault = new Firefly.Box.Date(1901, 1, 1);

            UserSettings.LoadIniFile(HttpContext.Current.Server.MapPath("Northwind.ini"));
        }
    }
} </code></pre>
<p>To explain in detail:</p>
<ol>
<li>Line 12 indicated that the application shouldn’t display message boxes etc…</li>
<li>Line 13 – indicated that the application should use .NET connection pools, which means that it’ll open connects and reuse them for multiple requests, using more connections when there is a load on the server, and less when the load is smaller.</li>
<li>Line 14-15 loads the configuration from the ini file. The “MapPath” method is used to reference the ini in the project directory. You can use any other path.</li>
</ol>
<p>In this method you should put any other configuration code that exists in the Program.Main, like “UserSettings.Version10Compatible = true;” for applications that were migrated from uniPaaS etc…</p>
<br /><hr />Help us improve, <a href="https://github.com/FireflyMigration/firefly-doc/blob/master//02-Development/03-Articles/Web-Development/Using-MVC-with-Migrated-Code/01-Setting-up-an-MVC-project-that-reuses-migrated-code/02-Application-setup-code/index.md" target="_blank">Edit this page on GitHub</a></div><!-- .content -->
                
            </div><!-- .container-->
        
            <aside class="left-sidebar">
                <div class="wy-side-nav-search-ff">
                    <a href="" class="test">  <img src="assets/img/logo-big.png"></a>
                </div><div id="menuTree"</div>
            </aside><!-- .left-sidebar -->

            <aside class="right-sidebar"></aside><!-- .right-sidebar -->

        </div><!-- .middle-->



    </div>


    <script src="assets/js/mermaid.js"></script>
    <script src="assets/js/prism-start.js"></script>
    <script src="assets/js/prism-clike.js"></script>
    <script src="assets/js/prism-markup.js"></script>
    <script src="assets/js/prism-css.js"></script>
    <script src="assets/js/prism-javascript.js"></script>

    <script src="assets/js/prism-diff.js"></script>
    <script src="assets/js/prism-csdiff.js"></script>
    <script src="assets/js/prism-function.js"></script>

    <script src="assets/js/jquery-3.1.1.js"></script>
    
    
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-4806432-3', 'auto');
  ga('send', 'pageview');

    </script>
    <script src="assets/js/tree.js"></script>
    <script language="javascript">
        buildTree('menuTree', 'application-setup-code.html', 'previousButton', 'nextButton');
    </script>
</body>
</html>