<!DOCTYPE html>
<html lang="en" class="js flexbox flexboxlegacy canvas canvastext webgl no-touch geolocation postmessage websqldatabase indexeddb hashchange history draganddrop websockets rgba hsla multiplebgs backgroundsize borderimage borderradius boxshadow textshadow opacity cssanimations csscolumns cssgradients cssreflections csstransforms csstransforms3d csstransitions fontface generatedcontent video audio localstorage sessionstorage webworkers applicationcache svg inlinesvg smil svgclippaths">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta charset="utf-8" />

    <title>THIS ARTICLE IS STILL UNDER CONSTRUCTION</title>
    
    <link rel="stylesheet" href="assets/css/prism.css" />
    <link rel="stylesheet" href="assets/css/prism-csdiff.css" />
    <link rel="stylesheet" href="assets/css/bootstrap.min.css" />
    
    <link rel="stylesheet" href="assets/css/theme.css" />
    <link rel="stylesheet" href="assets/css/theme_extra.css" />
    <link rel="stylesheet" href="assets/css/theme_firefly.css" />
</head>
<body class="wy-body-for-nav" role="document">
    <div class="wy-grid-for-nav">
        <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
            <div class="wy-side-nav-search-ff">
                <a href="" class="test">  <img src="assets/img/logo-big.png"></a>
            </div>

            <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1 "><a class="" href="">Home</a></li>
                    <li class="toctree-l1">
    <ul class="subnav">
        <li><span>dev docs</span></li>
        <li class="toctree-l1">
            <ul class="subnav">
                <li><span>guide</span></li>
                <li class="toctree-l1">
                    <ul class="subnav">
                        <li><span>An introduction to NET</span></li>
                        <li class="toctree-l1">
                            <ul class="subnav">
                                <li><span>Intro</span></li>
                                <li  class="toctree-l1"><a href="NET-Framework-Overview.html">NET Framework Overview</a></li>
                                <li  class="toctree-l1"><a href="Visual-Studio-and-CSharp-Overview.html">Visual Studio and CSharp Overview</a></li>
                                <li  class="toctree-l1"><a href="Create-a-simple-class.html">Create a simple class</a></li>
                                <li  class="toctree-l1"><a href="Explaining-The-Hello-world-example.html">Explaining The Hello world example</a></li>
                                <li  class="toctree-l1"><a href="Method-Arguments-and-Overloading.html">Method Arguments and Overloading</a></li>
                                <li  class="toctree-l1"><a href="Using-directives.html">Using directives</a></li>
                                <li  class="toctree-l1"><a href="Snippets.html">Snippets</a></li>
                                <li  class="toctree-l1"><a href="Comments.html">Comments</a></li>
                                <li  class="toctree-l1"><a href="Hello-csharp-exercise.html">Hello csharp exercise</a></li>
                            </ul>
                        </li>
                        <li class="toctree-l1">
                            <ul class="subnav">
                                <li  class="toctree-l1"><a href="Simple-data-types.html">Simple data types</a></li>
                                <li  class="toctree-l1"><a href="More-on-strings.html">More on strings</a></li>
                                <li  class="toctree-l1"><a href="Data-Types-Exercise.html">Data Types Exercise</a></li>
                            </ul>
                        </li>
                        <li class="toctree-l1">
                            <ul class="subnav">
                                <li  class="toctree-l1"><a href="Operators.html">Operators</a></li>
                                <li  class="toctree-l1"><a href="Operators-Exercise.html">Operators Exercise</a></li>
                            </ul>
                        </li>
                        <li class="toctree-l1">
                            <ul class="subnav">
                                <li  class="toctree-l1"><a href="More-On-Classes.html">More On Classes</a></li>
                                <li  class="toctree-l1"><a href="Constructor-Static_ReadOnly.html">Constructor Static_ReadOnly</a></li>
                            </ul>
                        </li>
                        <li  class="toctree-l1"><a href="student-notes.html">student notes</a></li>
                    </ul>
                </li>
                <li class="toctree-l1">
                    <ul class="subnav">
                        <li  class="toctree-l1"><a href="Getting-the-code-for-the-first-time.html">Getting the code for the first time</a></li>
                    </ul>
                </li>
                <li class="toctree-l1">
                    <ul class="subnav">
                        <li><span>Visual Studio Configuration</span></li>
                        <li  class="toctree-l1"><a href="file.html">file</a></li>
                    </ul>
                </li>
                <li  class="toctree-l1"><a href="using-version-control.html">using version control</a></li>
            </ul>
        </li>
        <li class="toctree-l1">
            <ul class="subnav">
                <li  class="toctree-l1"><a href="reference.html">reference</a></li>
                <li class="toctree-l1">
                    <ul class="subnav">
                        <li><span>Articles</span></li>
                        <li  class="toctree-l1"><a href="Automatic-Migration-Using-FTP.html">Automatic Migration Using FTP</a></li>
                        <li  class="toctree-l1"><a href="Error-report-guide.html">Error report guide</a></li>
                        <li  class="toctree-l1"><a href="Relations-in-depth.html">Relations in depth</a></li>
                        <li  class="toctree-l1"><a href="shoulddeterminenameaccordingtocallstack.html">shoulddeterminenameaccordingtocallstack</a></li>
                        <li  class="toctree-l1"><a href="Understanding-Error-Message-Details.html">Understanding Error Message Details</a></li>
                        <li  class="toctree-l1"><a href="Using-issue-tracker.html">Using issue tracker</a></li>
                        <li  class="toctree-l1"><a href="Using-Log-Files.html">Using Log Files</a></li>
                        <li  class="toctree-l1"><a href="View-SQL-Output.html">View SQL Output</a></li>
                    </ul>
                </li>
                <li class="toctree-l1">
                    <ul class="subnav">
                        <li><span>Comparing Migrated Code with Magic</span></li>
                        <li class="toctree-l1">
                            <ul class="subnav">
                                <li><span>eDevelopper</span></li>
                                <li  class="toctree-l1"><a href="Task-Properties.html">Task Properties</a></li>
                                <li  class="toctree-l1"><a href="Task-Control.html">Task Control</a></li>
                                <li  class="toctree-l1"><a href="IO-Files.html">IO Files</a></li>
                                <li  class="toctree-l1"><a href="DB-Tables.html">DB Tables</a></li>
                                <li  class="toctree-l1"><a href="Range-Locate.html">Range Locate</a></li>
                                <li  class="toctree-l1"><a href="The-Sort.html">The Sort</a></li>
                                <li  class="toctree-l1"><a href="Operations.html">Operations</a></li>
                                <li  class="toctree-l1"><a href="State-Comparison.html">State Comparison</a></li>
                                <li  class="toctree-l1"><a href="Handlers.html">Handlers</a></li>
                            </ul>
                        </li>
                        <li class="toctree-l1">
                            <ul class="subnav">
                                <li><span>Unipaas</span></li>
                                <li  class="toctree-l1"><a href="task-properties-unipaas.html">task properties unipaas</a></li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li class="toctree-l1">
                    <ul class="subnav">
                        <li><span>Refactoring</span></li>
                        <li  class="toctree-l1 current-page"><a href="Building-a-generic-GetName-method.html">Building a generic GetName method</a></li>
                        <li  class="toctree-l1"><a href="Obtaining-category-name-based-on-CategoryID.html">Obtaining category name based on CategoryID</a></li>
                    </ul>
                </li>
            </ul>
        </li>
    </ul>
</li>


                </ul>
            </div>
            &nbsp;
        </nav>
        <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
            <div class="wy-nav-content">
                <div class="rst-content">
                    <div role="main">
                        <a href="task-properties-unipaas.html"class="btn btn-neutral float-left">Previous</a> <a href="Obtaining-category-name-based-on-CategoryID.html"class="btn btn-neutral float-right">Next</a><br /><br />
                        <div class="section"><h1 id="this-article-is-still-under-construction">THIS ARTICLE IS STILL UNDER CONSTRUCTION</h1>
<h2 id="building-a-generic-method">Building a Generic Method</h2>
<h3 id="introduction">Introduction</h3>
<p>In the previous article, based on Tables from the Northwind Database, we discussed how to improvise our code to obtain a Category Name for different Classes such as ShowProducts and ShowPrices, without having to use a relation each time. We showed how we can build a Method either in the Entity Class or even better, in the Type Class, if one exists. We then can directly reference this Method from any Class that we wish.</p>
<h3 id="get-supplier-name">Get Supplier Name</h3>
<p>Let's build a similar BusinessProcess to get the Supplier Name, based on the SupplierID, as follows.</p>
<pre><code class="language-csharp">class GetSupplierName : BusinessProcessBase
{
    internal readonly Model.Suppliers _suppliers = new Model.Suppliers();
    TextColumn _result;
 
    public GetSupplierName()
    {
        From = _suppliers;            
    }
 
    public Text Run(Number pSupplierID)
    {
        Where.Add(_suppliers.SupplierID.IsEqualTo(pSupplierID));
        Execute();
        return _result;
    }
 
    protected override void OnLeaveRow()
    {
        _result = _suppliers.CompanyName;
    }
}
</code></pre>
<p>Now, let's define a Type called Supplier ID and add a Method to it that gets the Supplier Name:</p>
<pre><code class="language-csharp">class SupplierID : NumberColumn
{
    public SupplierID()
        : base(&quot;SupplierID&quot;, &quot;N10&quot;)
    {
    }
 
    public Text GetSupplierName()
    {
        return new DevDemo.GetSupplierName().Run(this);
    }
}
</code></pre>
<p>Having defined the Type, let's redefine the SupplierID column in the Supplier Entity to be of type SupplierID:</p>
<pre><code class="language-csharp">/// &lt;summary&gt;SupplierID&lt;/summary&gt;
public readonly Types.SupplierID SupplierID = new Types.SupplierID();
</code></pre>
<p>Now, as we did with GetCategoryName, let's create a virtual column called _supplierName and use BindValue to attach its value to the return value from GetSupplierName, as follows:</p>
<pre><code class="language-csharp">class ShowProductsUsingBP : UIControllerBase
{
    internal readonly Model.Products _products = new Model.Products();
 
    internal readonly TextColumn _categoryName = new TextColumn();
    internal readonly TextColumn _supplierName = new TextColumn(); 
 
    public ShowProductsUsingBP()
    {
        From = _products;
 
        _categoryName.BindValue(() =&gt; _products.CategoryID.GetCategoryName());
        _supplierName.BindValue(()=&gt; _products.SupplierID.GetSupplierName());
 
        View = new UI.ShowProductsUsingBPUI(this);
    }
 
    public void Run()
    {
        Execute();
    }
}
</code></pre>
<ul>
<li><p>Display the Supplier Name on the Screen by selecting the Virtual _supplierName Column.<br />
<img src="showproductswithsuppliername.jpg" alt="" /></p>
</li>
<li><p>As mentioned in the previous article, the GetSupplierName method is available from the SupplierID column as shown below:<br />
<img src="columngeneratorgetsuppliername.jpg" alt="" /></p>
</li>
</ul>
<h3 id="refactoring-the-code">Refactoring the code</h3>
<p>Looking at the code above, we note that we have two very similar Business Process Classes: GetCategoryName and GetSupplierName. Their methodology is exactly the same; they both accept an ID as a parameter and return a Text field containing the corresponding name. In addtion, they both lead to creating a Method on the Type Class of the ID Column that in turn, calls the Method to obtain the Name required.</p>
<p>Let's now combine the above two Methods into a Generic Method that can potentially accept a Number ID from any Table and return its corresponding Name. This will then allow us to maintain one Generic Business Class instead of a Business Class for every ID/Name pair.</p>
<h3 id="a-generic-method">A Generic Method</h3>
<p>To accomplish this task, let's build a Generic Business Process Class called GetNameFrom NumberID, that will accept in its Constructor, three parameters:</p>
<ul>
<li>Entity - Table Name</li>
<li>ID - NumberColumn</li>
<li>Name - TextColumn</li>
</ul>
<p>The code appears as follows:</p>
<pre><code class="language-csharp">class GetNameFromNumberID : BusinessProcessBase
{
    Text _result;
    TextColumn _name;
    NumberColumn _id;
       
    public GetNameFromNumberID(Entity myTable,NumberColumn numberColumnID,TextColumn resultNameColumn)
    {
        From = myTable;
        _name = resultNameColumn;
        _id = numberColumnID;
    }
        
    public Text Run(Number pNumberID)
    {
        Where.Add(_id.IsEqualTo(pNumberID));
        Execute();
        return _result; 
    }

    protected override void OnEnterRow()
    {
        _result = _name;
    }
}
</code></pre>
<p>This we have a generic Method which can receive a Numeric ID and return a Text Name.</p>
<p>The next stage is to call this Method from the Type Class.</p>
<p>This can be achieved with a code change to the Method in the Type class, as follows:</p>
<ul>
<li>Create a new Supplier Entity and pass it as the first parameter.</li>
<li>Pass the SupplierID and the Supplier Name as parameters 2 and 3, to be displayed on the screen.</li>
</ul>
<p>The code appears below:</p>
<pre><code class="language-csharp">class SupplierID : NumberColumn
{
    public SupplierID()
        : base(&quot;SupplierID&quot;, &quot;N10&quot;)
    {
    }
        
    public Text GetSupplierName()
    {
        var s = new Model.Suppliers();
        return new DevDemo.GetNameFromNumberID(s, s.SupplierID, s.CompanyName).Run(this);
    }
}
</code></pre>
<p>Having reached this stage, we can now eliminate the 2 Business Processes GetCategoryName and GetSupplierName</p>
</div>
                        
                        <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
                            <a href="task-properties-unipaas.html"class="btn btn-neutral float-left">Previous</a> <a href="Obtaining-category-name-based-on-CategoryID.html"class="btn btn-neutral float-right">Next</a>
                        </div>
                        
                        
                    </div>
                </div>
            </div>
        </section>

    </div>
    
    <script src="assets/js/prism.js"></script>
    <script src="assets/js/prism-csdiff.js"></script>
    <script src="assets/js/bootstrap.min.js"></script>
    <script src="assets/js/theme.js"></script>
</body>
</html>